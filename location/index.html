<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오시는 길 - 법무법인(유한) 예일법조</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    <style>
        body { font-family: 'Pretendard', sans-serif; }
        
        /* 메가메뉴 스타일 */
        .mega-menu {
            position: absolute;
            left: 0;
            right: 0;
            top: 100%;
            background: white;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            transform: translateY(-10px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
        }

        .mega-menu.active {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }

        /* 헤더 스타일 */
        .header-transparent {
            background-color: transparent;
        }

        .header-scrolled {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .mega-menu-open {
            background-color: white !important;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1) !important;
        }
        
        /* 지도 로딩 */
        .map-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: #f3f4f6;
        }
    </style>

    <!-- Navigation and Footer Modules -->
    <script src="../assets/js/nav.js"></script>
    <script src="../assets/js/footer.js"></script>
    
    <!-- 네이버 맵 API -->
    <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=YOUR_CLIENT_ID"></script>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Navigation will be inserted here by nav.js -->
    <div style="height: 80px;"></div>
    
    <!-- 브레드크럼 -->
    <section class="bg-white border-b">
        <div class="container mx-auto px-6 md:px-12 py-4">
            <nav class="flex items-center gap-2 text-sm text-gray-600">
                <a href="../index.html" class="hover:text-blue-600">홈</a>
                <span>/</span>
                <span class="text-gray-900">오시는 길</span>
                <span id="office-breadcrumb"></span>
            </nav>
        </div>
    </section>

    <!-- 히어로 섹션 -->
    <section class="relative h-[40vh] flex items-center bg-gradient-to-b from-gray-900 to-gray-800 overflow-hidden">
        <div class="absolute inset-0 bg-gradient-to-br from-blue-900/20 to-gray-900/50"></div>
        <div class="absolute inset-0">
            <div class="h-full w-full bg-[url('data:image/svg+xml,%3Csvg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"%3E%3Cg fill="none" fill-rule="evenodd"%3E%3Cg fill="%23ffffff" fill-opacity="0.03"%3E%3Cpath d="M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z"/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-30"></div>
        </div>
        <div class="container mx-auto px-6 md:px-12 relative z-10">
            <div class="text-center">
                <h1 id="page-title" class="text-5xl md:text-6xl font-bold text-white mb-6">오시는 길</h1>
                <p id="page-subtitle" class="text-xl md:text-2xl text-gray-300 max-w-3xl mx-auto">
                    법무법인(유한) 예일법조로 오시는 길을 안내해드립니다
                </p>
            </div>
        </div>
    </section>

    <main class="py-16">
        <div class="container mx-auto px-6 md:px-12">
            <!-- 지점 선택 버튼들 -->
            <div class="flex flex-wrap justify-center gap-3 mb-12">
                <button class="office-btn px-6 py-3 bg-gray-900 text-white rounded-full font-medium transition-all shadow-lg" data-office="seoul">
                    서울 본사
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="gangnam">
                    서울 강남
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="ulsan">
                    울산
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="daegu">
                    대구
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="cheongju">
                    청주
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="daejeon">
                    대전
                </button>
                <button class="office-btn px-6 py-3 bg-gray-100 text-gray-700 rounded-full font-medium hover:bg-gray-200 transition-all" data-office="gwangju">
                    광주
                </button>
            </div>

            <div class="max-w-6xl mx-auto">
                <!-- 지도 섹션 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden mb-12">
                    <div id="map" class="h-[500px]">
                        <div class="map-loading">
                            <div class="text-center">
                                <div class="w-16 h-16 bg-gray-300 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse">
                                    <svg class="w-8 h-8 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    </svg>
                                </div>
                                <p class="text-gray-600 text-lg font-medium">지도를 불러오는 중...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 상세 정보 -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- 기본 정보 -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <h2 class="text-2xl font-bold mb-6">사무소 정보</h2>
                        <div id="office-info" class="space-y-6">
                            <!-- 동적으로 채워집니다 -->
                        </div>
                    </div>

                    <!-- 교통편 안내 -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <h2 class="text-2xl font-bold mb-6">교통편 안내</h2>
                        <div id="transport-info" class="space-y-6">
                            <!-- 동적으로 채워집니다 -->
                        </div>
                    </div>
                    
                    <!-- 전문 분야 -->
                    <div class="bg-white rounded-2xl shadow-xl p-8">
                        <h2 class="text-2xl font-bold mb-6">전문 분야</h2>
                        <div id="specialty-info" class="space-y-4">
                            <!-- 동적으로 채워집니다 -->
                        </div>
                    </div>
                </div>
                
                <!-- 구성원 정보 -->
                <div class="bg-white rounded-2xl shadow-xl p-8 mt-8">
                    <h2 class="text-2xl font-bold mb-8">구성원 소개</h2>
                    <div id="members-info">
                        <!-- 동적으로 채워집니다 -->
                    </div>
                </div>

                <!-- 추가 안내사항 -->
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 rounded-2xl shadow-xl p-8 mt-8 text-white">
                    <h3 class="text-2xl font-bold mb-4">상담 예약 안내</h3>
                    <p class="mb-6 text-blue-100">방문 전 미리 연락주시면 더욱 원활한 상담이 가능합니다.</p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <a id="office-tel" href="tel:02-587-7787" class="inline-flex items-center justify-center gap-2 bg-white text-blue-600 py-3 px-6 rounded-lg font-medium hover:bg-gray-100 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <span id="office-tel-text">02-587-7787</span>
                        </a>
                        <a href="../contact/index.html" class="inline-flex items-center justify-center gap-2 bg-white/20 text-white py-3 px-6 rounded-lg font-medium hover:bg-white/30 transition-colors">
                            온라인 상담 신청
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let officesData = [];
        let lawyersData = [];
        let currentOffice = null;
        let map = null;
        let marker = null;

        // URL 파라미터에서 사무소 ID 가져오기
        function getOfficeFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('office') || 'seoul';
        }

        // 사무소 데이터 로드
        async function loadOfficeData() {
            try {
                const [officesResponse, lawyersResponse] = await Promise.all([
                    fetch('../data/offices.json'),
                    fetch('../data/lawyers.json')
                ]);
                officesData = await officesResponse.json();
                lawyersData = await lawyersResponse.json();
                
                // URL에서 사무소 확인
                const officeId = getOfficeFromUrl();
                selectOffice(officeId);
            } catch (error) {
                console.error('데이터 로드 실패:', error);
            }
        }

        // 사무소 선택
        function selectOffice(officeId) {
            const office = officesData.find(o => o.id === officeId);
            if (!office) return;

            currentOffice = office;
            
            // URL 업데이트 (페이지 새로고침 없이)
            const newUrl = `${window.location.pathname}?office=${officeId}`;
            window.history.pushState({ office: officeId }, '', newUrl);

            // 버튼 스타일 업데이트
            updateButtons(officeId);
            
            // 정보 업데이트
            updateOfficeInfo(office);
            
            // 지도 업데이트
            updateMap(office);
            
            // 페이지 제목 업데이트
            updatePageTitle(office);
            
            // 전문 분야 업데이트
            updateSpecialties(office);
            
            // 구성원 정보 업데이트
            updateMembers(office);
        }

        // 버튼 스타일 업데이트
        function updateButtons(officeId) {
            document.querySelectorAll('.office-btn').forEach(btn => {
                if (btn.dataset.office === officeId) {
                    btn.classList.remove('bg-gray-100', 'text-gray-700');
                    btn.classList.add('bg-gray-900', 'text-white', 'shadow-lg');
                } else {
                    btn.classList.remove('bg-gray-900', 'text-white', 'shadow-lg');
                    btn.classList.add('bg-gray-100', 'text-gray-700');
                }
            });
        }

        // 사무소 정보 업데이트
        function updateOfficeInfo(office) {
            // 기본 정보
            document.getElementById('office-info').innerHTML = `
                <div>
                    <h3 class="text-sm text-gray-600 mb-2 uppercase tracking-wider">주소</h3>
                    <p class="text-gray-900 text-lg">${office.address}</p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <h3 class="text-sm text-gray-600 mb-2 uppercase tracking-wider">전화</h3>
                        <p class="text-gray-900 font-medium">${office.tel}</p>
                    </div>
                    <div>
                        <h3 class="text-sm text-gray-600 mb-2 uppercase tracking-wider">팩스</h3>
                        <p class="text-gray-900">${office.fax}</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-sm text-gray-600 mb-2 uppercase tracking-wider">업무시간</h3>
                    <p class="text-gray-900">${office.hours}</p>
                </div>
                <div>
                    <h3 class="text-sm text-gray-600 mb-2 uppercase tracking-wider">주차</h3>
                    <p class="text-gray-900">${office.parking}</p>
                </div>
            `;

            // 교통편 정보
            document.getElementById('transport-info').innerHTML = `
                <div>
                    <h3 class="font-medium mb-3 flex items-center gap-2">
                        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                        </svg>
                        지하철
                    </h3>
                    <p class="text-gray-700">${office.subway}</p>
                </div>
                <div>
                    <h3 class="font-medium mb-3 flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                        </svg>
                        버스
                    </h3>
                    <p class="text-gray-700">${office.bus}</p>
                </div>
                <div class="pt-4 border-t">
                    <a href="https://map.naver.com/v5/search/${encodeURIComponent(office.address)}" 
                       target="_blank" 
                       class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                        </svg>
                        네이버 지도에서 상세 경로 보기
                    </a>
                </div>
            `;

            // 전화번호 업데이트
            const telNumber = office.tel.split(' / ')[0];
            document.getElementById('office-tel').href = `tel:${telNumber}`;
            document.getElementById('office-tel-text').textContent = telNumber;
        }

        // 지도 업데이트
        function updateMap(office) {
            if (typeof naver === 'undefined' || !naver.maps) {
                console.log('네이버 맵 API가 로드되지 않았습니다.');
                return;
            }

            const position = new naver.maps.LatLng(office.coordinates.lat, office.coordinates.lng);

            if (!map) {
                // 지도 초기화
                map = new naver.maps.Map('map', {
                    center: position,
                    zoom: 16
                });
            } else {
                // 기존 지도 중심 이동
                map.setCenter(position);
            }

            // 마커 업데이트
            if (marker) {
                marker.setMap(null);
            }

            marker = new naver.maps.Marker({
                position: position,
                map: map,
                title: office.name,
                icon: {
                    content: `<div class="bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium shadow-lg">
                                ${office.name}
                             </div>`,
                    anchor: new naver.maps.Point(60, 20)
                }
            });
        }

        // 페이지 제목 업데이트
        function updatePageTitle(office) {
            document.title = `${office.name} - 법무법인(유한) 예일법조`;
            document.getElementById('page-title').textContent = office.name;
            document.getElementById('page-subtitle').textContent = `${office.name}의 위치와 구성원을 안내해드립니다`;
            document.getElementById('office-breadcrumb').innerHTML = `
                <span>/</span>
                <span class="text-gray-900">${office.name}</span>
            `;
        }
        
        // 전문 분야 업데이트
        function updateSpecialties(office) {
            const specialtyContainer = document.getElementById('specialty-info');
            if (!office.specialties || office.specialties.length === 0) {
                specialtyContainer.innerHTML = '<p class="text-gray-500">전문 분야 정보가 없습니다.</p>';
                return;
            }
            
            specialtyContainer.innerHTML = office.specialties.map(specialty => `
                <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4">
                    <p class="font-medium text-blue-900 text-center">${specialty}</p>
                </div>
            `).join('');
        }
        
        // 구성원 정보 업데이트
        function updateMembers(office) {
            const membersContainer = document.getElementById('members-info');
            
            // 대표변호사
            const representatives = office.lawyers.representative
                .map(id => lawyersData.find(l => l.id === id))
                .filter(Boolean);
            
            // 소속변호사
            const members = office.lawyers.members
                .map(id => lawyersData.find(l => l.id === id))
                .filter(Boolean);
            
            let html = '';
            
            // 대표변호사 섹션
            if (representatives.length > 0) {
                html += `
                    <div class="mb-12">
                        <h3 class="text-xl font-bold mb-6 text-gray-800">대표변호사</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            ${representatives.map(lawyer => createLawyerCard(lawyer, true)).join('')}
                        </div>
                    </div>
                `;
            }
            
            // 소속변호사 섹션
            if (members.length > 0) {
                html += `
                    <div>
                        <h3 class="text-xl font-bold mb-6 text-gray-800">소속변호사</h3>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                            ${members.map(lawyer => createLawyerCard(lawyer, false)).join('')}
                        </div>
                    </div>
                `;
            }
            
            membersContainer.innerHTML = html || '<p class="text-gray-500 text-center">구성원 정보가 없습니다.</p>';
        }
        
        // 변호사 카드 생성
        function createLawyerCard(lawyer, isRepresentative) {
            if (isRepresentative) {
                return `
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-6 hover:shadow-lg transition-all">
                        <div class="text-center">
                            <img src="${lawyer.photo}" alt="${lawyer.name}" 
                                 class="w-32 h-32 rounded-full mx-auto mb-4 object-cover border-4 border-white shadow-lg">
                            <h4 class="text-xl font-bold text-gray-900 mb-1">${lawyer.name}</h4>
                            <p class="text-gray-600 mb-3">${lawyer.title}</p>
                            <p class="text-sm text-gray-500 mb-4">${lawyer.specialty}</p>
                            <div class="flex flex-wrap gap-2 justify-center">
                                ${(lawyer.expertise || []).slice(0, 3).map(exp => 
                                    `<span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs rounded-full">${exp}</span>`
                                ).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                return `
                    <div class="bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all text-center">
                        <img src="${lawyer.photo}" alt="${lawyer.name}" 
                             class="w-20 h-20 rounded-full mx-auto mb-3 object-cover">
                        <h4 class="font-bold text-gray-900">${lawyer.name}</h4>
                        <p class="text-sm text-gray-600 mb-1">${lawyer.title}</p>
                        <p class="text-xs text-gray-500">${lawyer.specialty}</p>
                    </div>
                `;
            }
        }

        // 이벤트 리스너
        document.addEventListener('DOMContentLoaded', function() {
            loadOfficeData();

            // 버튼 클릭 이벤트
            document.querySelectorAll('.office-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    selectOffice(this.dataset.office);
                });
            });

            // 브라우저 뒤로가기/앞으로가기 처리
            window.addEventListener('popstate', function(event) {
                const officeId = event.state?.office || getOfficeFromUrl();
                selectOffice(officeId);
            });
        });
    </script>
    
    <!-- Footer will be inserted here by footer.js -->
</body>
</html>